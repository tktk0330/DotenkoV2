# DotenkoV2 - ゲームフロー理解確認ドキュメント

**作成日**: 2024年12月  
**目的**: 要件すり合わせ後のゲームフロー理解を3つの具体例で確認する

---

## 🎮 **ゲームフロー理解確認 - 3つの具体例**

### 📋 **ケース1: 通常のどてんこ → チャレンジゾーン**

#### 🎯 **状況設定**
- 4人ゲーム：プレイヤー（自分）、BOT-A、BOT-B、BOT-C
- 現在の場のカード：♠7
- 手札状況：
  - プレイヤー：♥3, ♦4（合計7）
  - BOT-A：♣2, ♠6（合計8）
  - BOT-B：♥5, ♦2（合計7）← リベンジ可能
  - BOT-C：♠3, ♥2（合計5）

#### 🔄 **ゲームフロー**
1. **プレイヤーがどてんこ宣言**
   - 場：♠7、手札合計：7で一致
   
2. **どてんこアニメーション再生**
   - 「DOTENKO」の派手なアニメーション
   - この間、全ての操作無効
   
3. **チャレンジゾーン参加モーダル表示**
   - **プレイヤー**：「参加する」のみ（勝敗に絡んでいるため）
   - **BOT-A**：「参加する」「参加しない」（手札8 > 場7なので参加不可だが選択肢表示）
   - **BOT-B**：「リベンジ」「参加しない」（どてんこ条件満たすためリベンジ可能）
   - **BOT-C**：「参加する」「参加しない」（手札5 < 場7なので参加可能）

4. **各プレイヤーの応答**
   - プレイヤー：「参加する」選択
   - BOT-A：1秒遅延後「参加しない」選択
   - BOT-B：2秒遅延後「リベンジ」選択 ← **リベンジ発生！**
   - BOT-C：応答待ち...

5. **リベンジアニメーション**
   - BOT-Bのリベンジアニメーション再生
   - 勝敗変更：BOT-B勝者、プレイヤー敗者

6. **再度モーダル表示**
   - **プレイヤー**：「参加する」「参加しない」（もう勝敗に絡まない）
   - **BOT-A**：「参加する」「参加しない」
   - **BOT-B**：「参加する」のみ（勝敗に絡んでいるため）
   - **BOT-C**：「参加する」「参加しない」

7. **チャレンジゾーン開始**
   - 参加者：プレイヤー、BOT-B、BOT-C
   - **手札公開**：参加者の手札が全て表になる
   - 開始順：BOT-B（最後のリベンジ者）の次 → BOT-C → プレイヤー → BOT-B...

---

### 📋 **ケース2: しょてんこ → チャレンジゾーン**

#### 🎯 **状況設定**
- 3人ゲーム：プレイヤー、BOT-A、BOT-B
- ゲーム開始時、デッキから♦5が場に出る
- 手札状況：
  - プレイヤー：♥2, ♠3（合計5）← しょてんこ可能
  - BOT-A：♣4, ♦6（合計10）
  - BOT-B：♠7, ♥8（合計15）

#### 🔄 **ゲームフロー**
1. **ゲーム開始**
   - デッキから♦5が場に配布される
   
2. **しょてんこボタン表示**
   - プレイヤーにしょてんこボタンが表示される
   - BOTは条件満たさないので表示されない

3. **プレイヤーがしょてんこ宣言**
   - 手札合計5と場の♦5が一致
   
4. **しょてんこアニメーション**
   - 「SHOTENKO」アニメーション再生
   
5. **チャレンジゾーン参加モーダル表示**
   - **プレイヤー**：「参加する」のみ（勝者のため）
   - **BOT-A**：「参加する」「参加しない」（手札10 > 場5なので参加不可だが選択肢表示）
   - **BOT-B**：「参加する」「参加しない」（手札15 > 場5なので参加不可だが選択肢表示）

6. **応答結果**
   - 全員参加条件を満たさないため、チャレンジゾーンスキップ
   
7. **スコア計算**
   - しょてんこ勝者：プレイヤー
   - しょてんこ敗者：BOT-A、BOT-B（全員）

---

### 📋 **ケース3: 複数リベンジ競合 → チャレンジゾーン**

#### 🎯 **状況設定**
- 5人ゲーム：プレイヤー、BOT-A、BOT-B、BOT-C、BOT-D
- 現在の場のカード：♣9
- 手札状況：
  - プレイヤー：♥4, ♦5（合計9）← どてんこ可能
  - BOT-A：♠6, ♣3（合計9）← リベンジ可能
  - BOT-B：♥7, ♠2（合計9）← リベンジ可能
  - BOT-C：♦8, ♥3（合計11）
  - BOT-D：♠4, ♣2（合計6）

#### 🔄 **ゲームフロー**
1. **プレイヤーがどてんこ宣言**
   
2. **どてんこアニメーション**
   
3. **チャレンジゾーン参加モーダル表示**
   - **プレイヤー**：「参加する」のみ
   - **BOT-A**：「リベンジ」「参加しない」
   - **BOT-B**：「リベンジ」「参加しない」
   - **BOT-C**：「参加する」「参加しない」（手札11 > 場9）
   - **BOT-D**：「参加する」「参加しない」（手札6 < 場9）

4. **応答競合**
   - プレイヤー：「参加する」選択
   - BOT-A：1.5秒後「リベンジ」選択
   - BOT-B：1.2秒後「リベンジ」選択 ← **先着！**
   - BOT-C：2秒後「参加しない」選択
   - BOT-D：タイムアウト5秒 → 自動「参加する」

5. **BOT-Bのリベンジ成立**
   - BOT-Bが早い者勝ちでリベンジ成功
   - リベンジアニメーション再生
   - 勝敗変更：BOT-B勝者、プレイヤー敗者

6. **再度モーダル表示**
   - **プレイヤー**：「参加する」「参加しない」
   - **BOT-A**：「参加する」「参加しない」
   - **BOT-B**：「参加する」のみ（勝者のため）
   - **BOT-C**：「参加する」「参加しない」
   - **BOT-D**：「参加する」「参加しない」

7. **チャレンジゾーン開始**
   - 参加者：プレイヤー、BOT-B、BOT-D
   - 手札公開：参加者のみ
   - 開始順：BOT-C（BOT-Bの次）→ BOT-D → プレイヤー → BOT-A → BOT-B...

BOT-AはまだリベンジしてないのでBOT-Bの後にリベンジできます！
---

## 🤔 **確認したいポイント**

### 1. **モーダル表示対象**
- 全員に表示される理解で正しいですか？
→はい
- 勝敗に絡んでいない人にも表示される？
→はい

### 2. **参加条件を満たさないプレイヤー**
- 手札合計 > 場のカードの人にも「参加する」「参加しない」選択肢表示？
→参加しないのみで良いです
- それとも参加条件を満たさない場合は選択肢なし？

### 3. **チャレンジゾーンの開始順序**
- 最後にどてんこ/リベンジした人の次のプレイヤーから開始？
→はい
- 時計回りの順序は正しい？
→はい

### 4. **BOTの応答タイミング**
- リベンジ可能なBOTは必ず「リベンジ」を選択？
→はい
- 通常参加の場合は「参加する」を選択？
→はい
- 遅延時間は1-3秒程度？
→はい

### 5. **タイムアウト処理**
- 5秒でタイムアウト、デフォルト「参加する」で正しい？
→はい
- タイムアウト中は他のプレイヤーにローディング表示？
→はい

### 6. **しょてんこの特殊処理**
- しょてんこ後もチャレンジゾーン参加モーダルは表示される？
→はい
- 参加者がいない場合は即座にスコア計算？
→はい

---

## ❓ **追加確認事項**

### 質問13: チャレンジゾーン中のリベンジについて
「BOT-AはまだリベンジしてないのでBOT-Bの後にリベンジできます！」とありますが：

**例**: ケース3でチャレンジゾーン開始後、BOT-Aのターンが来た場合
- BOT-Aは「カードを引く」「リベンジ宣言」のどちらを選択？
- リベンジ宣言した場合、チャレンジゾーンは中断される？
- リベンジ後、再度チャレンジゾーン参加モーダルが表示される？
→違います。Bのリベンジによるアニメーション終了後、参加可否もーだるが出ると思います。そこでリベンジできます

### 質問14: 参加条件を満たさないプレイヤーのボタン表示
「参加しないのみで良いです」とありますが：

**例**: 手札合計 > 場のカードの場合
- ボタンは「参加しない」1つのみ表示？
→はい
- それとも「参加しない」ボタンが自動選択された状態？
→いや自動選択はなし
- 選択の余地がない場合、ボタン表示は必要？
→ボタンは表示されるけど非活性

### 質問15: チャレンジゾーン中の手札公開タイミング
参加者の手札公開について：

**例**: チャレンジゾーン開始時に3人参加、途中で1人がリベンジした場合
- リベンジした人の手札も即座に公開される？
→はい
- 新たに参加する人がいる場合の手札公開タイミングは？
- 公開された手札は全プレイヤーから見える？
→はい、手札が表になります

### 質問16: しょてんこボタンの表示条件詳細
「誰かがカードを出した瞬間にしょてんこボタンは消える」について：

**例**: デッキから♦5が出て、プレイヤーの手札合計も5の場合
- しょてんこボタンが表示される
- 他のプレイヤーがカードを出す
- この瞬間にしょてんこボタンは消える？
- 消えた後は通常のどてんこボタンに変わる？
→どてんこできるのであればそうです。
---

**この理解で正しいかご確認ください。間違いがあれば修正いたします。** 